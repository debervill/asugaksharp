<Window x:Class="asugaksharp.Features.Oplata.OplataWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Расчёт оплаты" Height="650" Width="1300"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Панель выбора кафедры и ГАК -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Кафедра:" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <ComboBox x:Name="ComboBoxKafedra"
                      Width="250"
                      DisplayMemberPath="Name"
                      SelectionChanged="ComboBoxKafedra_SelectionChanged"/>

            <TextBlock Text="ГАК:" VerticalAlignment="Center" Margin="20,0,10,0"/>
            <ComboBox x:Name="ComboBoxGak"
                      Width="200"
                      DisplayMemberPath="NomerPrikaza"/>

            <Button Content="Загрузить" Width="100" Margin="20,0,0,0" Click="LoadButton_Click"/>
            <Button Content="Сохранить всё" Width="100" Margin="10,0,0,0" Click="SaveAllButton_Click"
                    x:Name="ButtonSaveAll" IsEnabled="False"/>
        </StackPanel>

        <!-- Информация о ГАК и параметры расчёта -->
        <GroupBox Grid.Row="1" Header="Параметры расчёта (общие)" Margin="0,0,0,10">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="Бюджет:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="Bold"/>
                <TextBox Grid.Column="1" x:Name="TextBoxKolvoBudget" IsReadOnly="True" Background="LightGray"/>

                <TextBlock Grid.Column="2" Text="Платка:" VerticalAlignment="Center" Margin="20,0,10,0" FontWeight="Bold"/>
                <TextBox Grid.Column="3" x:Name="TextBoxKolvoPlatka" IsReadOnly="True" Background="LightGray"/>

                <TextBlock Grid.Column="4" Text="Стоимость часа:" VerticalAlignment="Center" Margin="20,0,10,0"/>
                <TextBox Grid.Column="5" x:Name="TextBoxStoimostChasa"/>

                <Button Grid.Column="6" Content="Применить ко всем" Width="130" Margin="20,0,0,0" Click="ApplyToAllButton_Click"/>

                <!-- Кнопка Документы с выпадающим меню -->
                <Button Grid.Column="7" x:Name="ButtonDocuments" Content="Документы ▼" Width="120" Margin="10,0,0,0"
                        IsEnabled="False" Click="ButtonDocuments_Click" HorizontalAlignment="Left">
                    <Button.ContextMenu>
                        <ContextMenu x:Name="DocumentsContextMenu">
                            <MenuItem Header="Сгенерировать все документы" Click="GenerateAllDocuments_Click"/>
                            <Separator/>
                            <MenuItem Header="Договоры ГПХ" Click="GenerateDogovors_Click"/>
                            <MenuItem Header="Акты выполненных работ" Click="GenerateAkts_Click"/>
                            <MenuItem Header="Заявления" Click="GenerateZayavleniya_Click"/>
                            <Separator/>
                            <MenuItem Header="Документы для выбранного..." x:Name="MenuSelectedPerson" IsEnabled="False">
                                <MenuItem Header="Все документы" Click="GenerateAllForSelected_Click"/>
                                <Separator/>
                                <MenuItem Header="Договор ГПХ" Click="GenerateDogovorForSelected_Click"/>
                                <MenuItem Header="Акт выполненных работ" Click="GenerateAktForSelected_Click"/>
                                <MenuItem Header="Заявление" Click="GenerateZayavlenieForSelected_Click"/>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Header="Открыть папку с документами" Click="OpenDocumentsFolder_Click"/>
                        </ContextMenu>
                    </Button.ContextMenu>
                </Button>
            </Grid>
        </GroupBox>

        <!-- Таблица внешних членов комиссии с расчётами -->
        <DataGrid Grid.Row="2"
                  x:Name="DataGridOplata"
                  AutoGenerateColumns="False"
                  IsReadOnly="False"
                  SelectionMode="Extended"
                  SelectionUnit="CellOrRowHeader"
                  ClipboardCopyMode="ExcludeHeader"
                  CanUserAddRows="False"
                  CellEditEnding="DataGridOplata_CellEditEnding">
            <DataGrid.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Копировать" Click="CopyMenuItem_Click" InputGestureText="Ctrl+C"/>
                </ContextMenu>
            </DataGrid.ContextMenu>
            <DataGrid.Columns>
                <DataGridTextColumn Header="ФИО" Binding="{Binding PersonName}" Width="180" IsReadOnly="True"/>
                <DataGridTextColumn Header="Роль" Binding="{Binding RolVGek}" Width="90" IsReadOnly="True"/>
                <DataGridTextColumn Header="Бюджет" Binding="{Binding KolvoBudget}" Width="70"/>
                <DataGridTextColumn Header="Платка" Binding="{Binding KolvoPlatka}" Width="70"/>
                <DataGridTextColumn Header="Всего" Binding="{Binding KolvoStudentov}" Width="60" IsReadOnly="True"/>
                <DataGridTextColumn Header="Коэфф." Binding="{Binding Koefficient, StringFormat=F2}" Width="70"/>
                <DataGridTextColumn Header="Академ. ч." Binding="{Binding AkademChasov, StringFormat=F2}" Width="80" IsReadOnly="True"/>
                <DataGridTextColumn Header="Астроном. ч." Binding="{Binding AstronomChasov, StringFormat=F2}" Width="90" IsReadOnly="True"/>
                <DataGridTextColumn Header="Ст-ть часа" Binding="{Binding StoimostChasa, StringFormat=F2}" Width="80"/>
                <DataGridTextColumn Header="Ст-ть акад. часа с налогами" Binding="{Binding StoimostAkademChasaSNalogami, StringFormat=F2}" Width="140" IsReadOnly="True"/>
                <DataGridTextColumn Header="Общая стоимость услуг" Binding="{Binding ObshayaStoimostUslugPoDogovoru, StringFormat=F2}" Width="140" IsReadOnly="True"/>
                <DataGridTextColumn Header="Начислено" Binding="{Binding SummaBezNalogov, StringFormat=F2}" Width="100" IsReadOnly="True"/>
                <DataGridTextColumn Header="НДФЛ (13%)" Binding="{Binding NdflSumma, StringFormat=F2}" Width="90" IsReadOnly="True"/>
                <DataGridTextColumn Header="ЕНП (30%)" Binding="{Binding EnpSumma, StringFormat=F2}" Width="90" IsReadOnly="True"/>
                <DataGridTextColumn Header="К выплате" Binding="{Binding SummaKVyplate, StringFormat=F2}" Width="100" IsReadOnly="True"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Итого -->
        <GroupBox Grid.Row="3" Header="Итого" Margin="0,10,0,0">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="Начислено:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="Bold"/>
                <TextBox Grid.Column="1" x:Name="TextBoxTotalNachisleno" IsReadOnly="True" Background="LightGray"/>

                <TextBlock Grid.Column="2" Text="НДФЛ:" VerticalAlignment="Center" Margin="20,0,10,0" FontWeight="Bold"/>
                <TextBox Grid.Column="3" x:Name="TextBoxTotalNdfl" IsReadOnly="True" Background="LightGray"/>

                <TextBlock Grid.Column="4" Text="ЕНП:" VerticalAlignment="Center" Margin="20,0,10,0" FontWeight="Bold"/>
                <TextBox Grid.Column="5" x:Name="TextBoxTotalEnp" IsReadOnly="True" Background="LightGray"/>

                <TextBlock Grid.Column="6" Text="К выплате:" VerticalAlignment="Center" Margin="20,0,10,0" FontWeight="Bold"/>
                <TextBox Grid.Column="7" x:Name="TextBoxTotalKVyplate" IsReadOnly="True" Background="LightGreen" FontWeight="Bold"/>
            </Grid>
        </GroupBox>
    </Grid>
</Window>
